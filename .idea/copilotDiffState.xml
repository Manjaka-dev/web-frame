<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/webframe/core/tools/modelView.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/webframe/core/tools/modelView.java" />
              <option name="originalContent" value="package webframe.core.tools;&#10;&#10;import java.lang.reflect.Method;&#10;&#10;public class modelView {&#10;&#10;    private String url;&#10;    private Method method;&#10;    private String view;&#10;    private Class&lt;?&gt; controller;&#10;}&#10;" />
              <option name="updatedContent" value="package webframe.core.tools;&#10;&#10;import java.lang.reflect.Method;&#10;&#10;/**&#10; * Représente une route associant une URL, une méthode de contrôleur et une vue.&#10; */&#10;public class ModelView {&#10;&#10;    private String url;&#10;    private Method method;&#10;    private String view;&#10;    private Class&lt;?&gt; controller;&#10;    &#10;    public ModelView() {}&#10;    &#10;    public ModelView(String url, Method method, String view, Class&lt;?&gt; controller) {&#10;        this.url = url;&#10;        this.method = method;&#10;        this.view = view;&#10;        this.controller = controller;&#10;    }&#10;    &#10;    // Getters&#10;    public String getUrl() {&#10;        return url;&#10;    }&#10;    &#10;    public Method getMethod() {&#10;        return method;&#10;    }&#10;    &#10;    public String getView() {&#10;        return view;&#10;    }&#10;    &#10;    public Class&lt;?&gt; getController() {&#10;        return controller;&#10;    }&#10;    &#10;    // Setters&#10;    public void setUrl(String url) {&#10;        this.url = url;&#10;    }&#10;    &#10;    public void setMethod(Method method) {&#10;        this.method = method;&#10;    }&#10;    &#10;    public void setView(String view) {&#10;        this.view = view;&#10;    }&#10;    &#10;    public void setController(Class&lt;?&gt; controller) {&#10;        this.controller = controller;&#10;    }&#10;    &#10;    @Override&#10;    public String toString() {&#10;        return String.format(&quot;ModelView{url='%s', method='%s', view='%s', controller='%s'}&quot;, &#10;                           url, &#10;                           method != null ? method.getName() : &quot;null&quot;,&#10;                           view,&#10;                           controller != null ? controller.getSimpleName() : &quot;null&quot;);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/webframe/test/FormTest.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/webframe/test/FormTest.java" />
              <option name="originalContent" value="package webframe.test;&#10;&#10;import webframe.core.util.ParameterResolver;&#10;import webframe.core.annotation.RequestParam;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;&#10;import java.lang.reflect.Method;&#10;import java.lang.reflect.Parameter;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;/**&#10; * Test pour vérifier le fonctionnement du système de formulaires et @RequestParam.&#10; */&#10;public class FormTest {&#10;&#10;    public static void main(String[] args) {&#10;        System.out.println(&quot;=== Test du Système de Formulaires ===\n&quot;);&#10;&#10;        testParameterResolution();&#10;        testAnnotationParsing();&#10;        testParameterValidation();&#10;    }&#10;&#10;    private static void testParameterResolution() {&#10;        System.out.println(&quot;1. Test de résolution des paramètres:&quot;);&#10;&#10;        try {&#10;            // Simuler une requête HTTP&#10;            MockHttpServletRequest request = new MockHttpServletRequest();&#10;            request.addParameter(&quot;username&quot;, &quot;john_doe&quot;);&#10;            request.addParameter(&quot;email&quot;, &quot;john@example.com&quot;);&#10;            request.addParameter(&quot;age&quot;, &quot;25&quot;);&#10;            request.addParameter(&quot;country&quot;, &quot;France&quot;);&#10;&#10;            // Récupérer la méthode du contrôleur&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class);&#10;&#10;            // Résoudre les paramètres&#10;            Object[] args = ParameterResolver.resolveParameters(method, request);&#10;&#10;            System.out.printf(&quot;  Paramètres résolus: %d arguments%n&quot;, args.length);&#10;            System.out.printf(&quot;    username: %s (String)%n&quot;, args[0]);&#10;            System.out.printf(&quot;    email: %s (String)%n&quot;, args[1]);&#10;            System.out.printf(&quot;    age: %s (%s)%n&quot;, args[2], args[2].getClass().getSimpleName());&#10;            System.out.printf(&quot;    country: %s (String)%n&quot;, args[3]);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    private static void testAnnotationParsing() {&#10;        System.out.println(&quot;2. Test d'analyse des annotations:&quot;);&#10;&#10;        try {&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class);&#10;&#10;            Parameter[] parameters = method.getParameters();&#10;            for (int i = 0; i &lt; parameters.length; i++) {&#10;                Parameter param = parameters[i];&#10;                RequestParam annotation = param.getAnnotation(RequestParam.class);&#10;&#10;                System.out.printf(&quot;  Paramètre %d: %s%n&quot;, i + 1, param.getName());&#10;                if (annotation != null) {&#10;                    System.out.printf(&quot;    @RequestParam(value='%s', name='%s', required=%s, defaultValue='%s')%n&quot;,&#10;                        annotation.value(), annotation.name(), annotation.required(), annotation.defaultValue());&#10;                } else {&#10;                    System.out.println(&quot;    Pas d'annotation @RequestParam&quot;);&#10;                }&#10;            }&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    private static void testParameterValidation() {&#10;        System.out.println(&quot;3. Test de validation des paramètres:&quot;);&#10;&#10;        try {&#10;            // Test avec paramètre manquant mais valeur par défaut&#10;            MockHttpServletRequest request1 = new MockHttpServletRequest();&#10;            request1.addParameter(&quot;username&quot;, &quot;jane_doe&quot;);&#10;            request1.addParameter(&quot;email&quot;, &quot;jane@example.com&quot;);&#10;            // age et country manquants, mais ont des valeurs par défaut&#10;&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class);&#10;&#10;            Object[] args1 = ParameterResolver.resolveParameters(method, request1);&#10;            System.out.printf(&quot;  Test valeurs par défaut: age=%s, country=%s%n&quot;, args1[2], args1[3]);&#10;&#10;            // Test avec paramètre requis manquant&#10;            MockHttpServletRequest request2 = new MockHttpServletRequest();&#10;            request2.addParameter(&quot;email&quot;, &quot;test@example.com&quot;);&#10;            // username manquant et requis&#10;&#10;            try {&#10;                ParameterResolver.resolveParameters(method, request2);&#10;                System.out.println(&quot;  Erreur: devrait lever une exception pour paramètre requis manquant&quot;);&#10;            } catch (IllegalArgumentException e) {&#10;                System.out.printf(&quot;  ✓ Exception attendue pour paramètre requis manquant: %s%n&quot;, e.getMessage());&#10;            }&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;&#10;        System.out.println(&quot; Le système de formulaires fonctionne correctement !&quot;);&#10;        System.out.println(&quot;   - @RequestParam supporte value, name, required, defaultValue&quot;);&#10;        System.out.println(&quot;   - Conversion automatique des types (String, int, double, boolean, etc.)&quot;);&#10;        System.out.println(&quot;   - Validation des paramètres requis&quot;);&#10;        System.out.println(&quot;   - Support des valeurs par défaut&quot;);&#10;    }&#10;&#10;    /**&#10;     * Mock simple de HttpServletRequest pour les tests&#10;     */&#10;    private static class MockHttpServletRequest implements HttpServletRequest {&#10;        private Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();&#10;&#10;        public void addParameter(String name, String value) {&#10;            parameters.put(name, value);&#10;        }&#10;&#10;        @Override&#10;        public String getParameter(String name) {&#10;            return parameters.get(name);&#10;        }&#10;&#10;        // Autres méthodes de HttpServletRequest (stubs pour les tests)&#10;        @Override public String getAuthType() { return null; }&#10;        @Override public javax.servlet.http.Cookie[] getCookies() { return new javax.servlet.http.Cookie[0]; }&#10;        @Override public long getDateHeader(String name) { return 0; }&#10;        @Override public String getHeader(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getHeaders(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getHeaderNames() { return null; }&#10;        @Override public int getIntHeader(String name) { return 0; }&#10;        @Override public String getMethod() { return &quot;GET&quot;; }&#10;        @Override public String getPathInfo() { return null; }&#10;        @Override public String getPathTranslated() { return null; }&#10;        @Override public String getContextPath() { return &quot;&quot;; }&#10;        @Override public String getQueryString() { return null; }&#10;        @Override public String getRemoteUser() { return null; }&#10;        @Override public boolean isUserInRole(String role) { return false; }&#10;        @Override public java.security.Principal getUserPrincipal() { return null; }&#10;        @Override public String getRequestedSessionId() { return null; }&#10;        @Override public String getRequestURI() { return &quot;/&quot;; }&#10;        @Override public StringBuffer getRequestURL() { return new StringBuffer(&quot;http://localhost/&quot;); }&#10;        @Override public String getServletPath() { return &quot;&quot;; }&#10;        @Override public javax.servlet.http.HttpSession getSession(boolean create) { return null; }&#10;        @Override public javax.servlet.http.HttpSession getSession() { return null; }&#10;        @Override public String changeSessionId() { return null; }&#10;        @Override public boolean isRequestedSessionIdValid() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromCookie() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromURL() { return false; }&#10;        @Override public boolean authenticate(javax.servlet.http.HttpServletResponse response) { return false; }&#10;        @Override public void login(String username, String password) {}&#10;        @Override public void logout() {}&#10;        @Override public java.util.Collection&lt;javax.servlet.http.Part&gt; getParts() { return null; }&#10;        @Override public javax.servlet.http.Part getPart(String name) { return null; }&#10;        @Override public &lt;T extends javax.servlet.http.HttpUpgradeHandler&gt; T upgrade(Class&lt;T&gt; httpUpgradeHandlerClass) { return null; }&#10;        @Override public Object getAttribute(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getAttributeNames() { return null; }&#10;        @Override public String getCharacterEncoding() { return &quot;UTF-8&quot;; }&#10;        @Override public void setCharacterEncoding(String env) {}&#10;        @Override public int getContentLength() { return 0; }&#10;        @Override public long getContentLengthLong() { return 0; }&#10;        @Override public String getContentType() { return &quot;application/x-www-form-urlencoded&quot;; }&#10;        @Override public javax.servlet.ServletInputStream getInputStream() { return null; }&#10;        @Override public java.util.Map&lt;String, String[]&gt; getParameterMap() {&#10;            Map&lt;String, String[]&gt; map = new HashMap&lt;&gt;();&#10;            for (Map.Entry&lt;String, String&gt; entry : parameters.entrySet()) {&#10;                map.put(entry.getKey(), new String[]{entry.getValue()});&#10;            }&#10;            return map;&#10;        }&#10;        @Override public java.util.Enumeration&lt;String&gt; getParameterNames() {&#10;            return java.util.Collections.enumeration(parameters.keySet());&#10;        }&#10;        @Override public String[] getParameterValues(String name) {&#10;            String value = parameters.get(name);&#10;            return value != null ? new String[]{value} : null;&#10;        }&#10;        @Override public String getProtocol() { return &quot;HTTP/1.1&quot;; }&#10;        @Override public String getScheme() { return &quot;http&quot;; }&#10;        @Override public String getServerName() { return &quot;localhost&quot;; }&#10;        @Override public int getServerPort() { return 8080; }&#10;        @Override public java.io.BufferedReader getReader() { return null; }&#10;        @Override public String getRemoteAddr() { return &quot;127.0.0.1&quot;; }&#10;        @Override public String getRemoteHost() { return &quot;localhost&quot;; }&#10;        @Override public void setAttribute(String name, Object o) {}&#10;        @Override public void removeAttribute(String name) {}&#10;        @Override public java.util.Locale getLocale() { return java.util.Locale.getDefault(); }&#10;        @Override public java.util.Enumeration&lt;java.util.Locale&gt; getLocales() { return null; }&#10;        @Override public boolean isSecure() { return false; }&#10;        @Override public javax.servlet.RequestDispatcher getRequestDispatcher(String path) { return null; }&#10;        @Override public int getRemotePort() { return 0; }&#10;        @Override public String getLocalName() { return &quot;localhost&quot;; }&#10;        @Override public String getLocalAddr() { return &quot;127.0.0.1&quot;; }&#10;        @Override public int getLocalPort() { return 8080; }&#10;        @Override public javax.servlet.ServletContext getServletContext() { return null; }&#10;        @Override public javax.servlet.AsyncContext startAsync() { return null; }&#10;        @Override public javax.servlet.AsyncContext startAsync(javax.servlet.ServletRequest servletRequest, javax.servlet.ServletResponse servletResponse) { return null; }&#10;        @Override public boolean isAsyncStarted() { return false; }&#10;        @Override public boolean isAsyncSupported() { return false; }&#10;        @Override public javax.servlet.AsyncContext getAsyncContext() { return null; }&#10;        @Override public javax.servlet.DispatcherType getDispatcherType() { return javax.servlet.DispatcherType.REQUEST; }&#10;        @Override public String getRequestId() { return &quot;test-request-id&quot;; }&#10;        @Override public String getProtocolRequestId() { return &quot;test-protocol-request-id&quot;; }&#10;        @Override public javax.servlet.ServletConnection getServletConnection() { return null; }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package webframe.test;&#10;&#10;import webframe.core.util.ParameterResolver;&#10;import webframe.core.annotation.RequestParam;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;&#10;import java.lang.reflect.Method;&#10;import java.lang.reflect.Parameter;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;/**&#10; * Test pour vérifier le fonctionnement du système de formulaires et @RequestParam.&#10; */&#10;public class FormTest {&#10;&#10;    public static void main(String[] args) {&#10;        System.out.println(&quot;=== Test du Système de Formulaires ===\n&quot;);&#10;&#10;        testParameterResolution();&#10;        testAnnotationParsing();&#10;        testParameterValidation();&#10;    }&#10;&#10;    private static void testParameterResolution() {&#10;        System.out.println(&quot;1. Test de résolution des paramètres:&quot;);&#10;&#10;        try {&#10;            // Simuler une requête HTTP&#10;            MockHttpServletRequest request = new MockHttpServletRequest();&#10;            request.addParameter(&quot;username&quot;, &quot;john_doe&quot;);&#10;            request.addParameter(&quot;email&quot;, &quot;john@example.com&quot;);&#10;            request.addParameter(&quot;age&quot;, &quot;25&quot;);&#10;            request.addParameter(&quot;country&quot;, &quot;France&quot;);&#10;&#10;            // Récupérer la méthode du contrôleur&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class);&#10;&#10;            // Résoudre les paramètres&#10;            Object[] args = ParameterResolver.resolveParameters(method, request);&#10;&#10;            System.out.printf(&quot;  Paramètres résolus: %d arguments%n&quot;, args.length);&#10;            System.out.printf(&quot;    username: %s (String)%n&quot;, args[0]);&#10;            System.out.printf(&quot;    email: %s (String)%n&quot;, args[1]);&#10;            System.out.printf(&quot;    age: %s (%s)%n&quot;, args[2], args[2].getClass().getSimpleName());&#10;            System.out.printf(&quot;    country: %s (String)%n&quot;, args[3]);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    private static void testAnnotationParsing() {&#10;        System.out.println(&quot;2. Test d'analyse des annotations:&quot;);&#10;&#10;        try {&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class);&#10;&#10;            Parameter[] parameters = method.getParameters();&#10;            for (int i = 0; i &lt; parameters.length; i++) {&#10;                Parameter param = parameters[i];&#10;                RequestParam annotation = param.getAnnotation(RequestParam.class);&#10;&#10;                System.out.printf(&quot;  Paramètre %d: %s%n&quot;, i + 1, param.getName());&#10;                if (annotation != null) {&#10;                    System.out.printf(&quot;    @RequestParam(value='%s', name='%s', required=%s, defaultValue='%s')%n&quot;,&#10;                        annotation.value(), annotation.name(), annotation.required(), annotation.defaultValue());&#10;                } else {&#10;                    System.out.println(&quot;    Pas d'annotation @RequestParam&quot;);&#10;                }&#10;            }&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    private static void testParameterValidation() {&#10;        System.out.println(&quot;3. Test de validation des paramètres:&quot;);&#10;&#10;        try {&#10;            // Test avec paramètre manquant mais valeur par défaut&#10;            MockHttpServletRequest request1 = new MockHttpServletRequest();&#10;            request1.addParameter(&quot;username&quot;, &quot;jane_doe&quot;);&#10;            request1.addParameter(&quot;email&quot;, &quot;jane@example.com&quot;);&#10;            // age et country manquants, mais ont des valeurs par défaut&#10;&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class);&#10;&#10;            Object[] args1 = ParameterResolver.resolveParameters(method, request1);&#10;            System.out.printf(&quot;  Test valeurs par défaut: age=%s, country=%s%n&quot;, args1[2], args1[3]);&#10;&#10;            // Test avec paramètre requis manquant&#10;            MockHttpServletRequest request2 = new MockHttpServletRequest();&#10;            request2.addParameter(&quot;email&quot;, &quot;test@example.com&quot;);&#10;            // username manquant et requis&#10;&#10;            try {&#10;                ParameterResolver.resolveParameters(method, request2);&#10;                System.out.println(&quot;  Erreur: devrait lever une exception pour paramètre requis manquant&quot;);&#10;            } catch (IllegalArgumentException e) {&#10;                System.out.printf(&quot;  ✓ Exception attendue pour paramètre requis manquant: %s%n&quot;, e.getMessage());&#10;            }&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;&#10;        System.out.println(&quot; Le système de formulaires fonctionne correctement !&quot;);&#10;        System.out.println(&quot;   - @RequestParam supporte value, name, required, defaultValue&quot;);&#10;        System.out.println(&quot;   - Conversion automatique des types (String, int, double, boolean, etc.)&quot;);&#10;        System.out.println(&quot;   - Validation des paramètres requis&quot;);&#10;        System.out.println(&quot;   - Support des valeurs par défaut&quot;);&#10;    }&#10;&#10;    /**&#10;     * Mock simple de HttpServletRequest pour les tests&#10;     */&#10;    private static class MockHttpServletRequest implements HttpServletRequest {&#10;        private Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();&#10;&#10;        public void addParameter(String name, String value) {&#10;            parameters.put(name, value);&#10;        }&#10;&#10;        @Override&#10;        public String getParameter(String name) {&#10;            return parameters.get(name);&#10;        }&#10;&#10;        // Autres méthodes de HttpServletRequest (stubs pour les tests)&#10;        @Override public String getAuthType() { return null; }&#10;        @Override public javax.servlet.http.Cookie[] getCookies() { return new javax.servlet.http.Cookie[0]; }&#10;        @Override public long getDateHeader(String name) { return 0; }&#10;        @Override public String getHeader(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getHeaders(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getHeaderNames() { return null; }&#10;        @Override public int getIntHeader(String name) { return 0; }&#10;        @Override public String getMethod() { return &quot;GET&quot;; }&#10;        @Override public String getPathInfo() { return null; }&#10;        @Override public String getPathTranslated() { return null; }&#10;        @Override public String getContextPath() { return &quot;&quot;; }&#10;        @Override public String getQueryString() { return null; }&#10;        @Override public String getRemoteUser() { return null; }&#10;        @Override public boolean isUserInRole(String role) { return false; }&#10;        @Override public java.security.Principal getUserPrincipal() { return null; }&#10;        @Override public String getRequestedSessionId() { return null; }&#10;        @Override public String getRequestURI() { return &quot;/&quot;; }&#10;        @Override public StringBuffer getRequestURL() { return new StringBuffer(&quot;http://localhost/&quot;); }&#10;        @Override public String getServletPath() { return &quot;&quot;; }&#10;        @Override public javax.servlet.http.HttpSession getSession(boolean create) { return null; }&#10;        @Override public javax.servlet.http.HttpSession getSession() { return null; }&#10;        @Override public String changeSessionId() { return null; }&#10;        @Override public boolean isRequestedSessionIdValid() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromCookie() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromURL() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromUrl() { return false; }&#10;        @Override public boolean authenticate(javax.servlet.http.HttpServletResponse response) { return false; }&#10;        @Override public void login(String username, String password) {}&#10;        @Override public void logout() {}&#10;        @Override public java.util.Collection&lt;javax.servlet.http.Part&gt; getParts() { return null; }&#10;        @Override public javax.servlet.http.Part getPart(String name) { return null; }&#10;        @Override public &lt;T extends javax.servlet.http.HttpUpgradeHandler&gt; T upgrade(Class&lt;T&gt; httpUpgradeHandlerClass) { return null; }&#10;        @Override public Object getAttribute(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getAttributeNames() { return null; }&#10;        @Override public String getCharacterEncoding() { return &quot;UTF-8&quot;; }&#10;        @Override public void setCharacterEncoding(String env) {}&#10;        @Override public int getContentLength() { return 0; }&#10;        @Override public long getContentLengthLong() { return 0; }&#10;        @Override public String getContentType() { return &quot;application/x-www-form-urlencoded&quot;; }&#10;        @Override public javax.servlet.ServletInputStream getInputStream() { return null; }&#10;        @Override public java.util.Map&lt;String, String[]&gt; getParameterMap() {&#10;            Map&lt;String, String[]&gt; map = new HashMap&lt;&gt;();&#10;            for (Map.Entry&lt;String, String&gt; entry : parameters.entrySet()) {&#10;                map.put(entry.getKey(), new String[]{entry.getValue()});&#10;            }&#10;            return map;&#10;        }&#10;        @Override public java.util.Enumeration&lt;String&gt; getParameterNames() {&#10;            return java.util.Collections.enumeration(parameters.keySet());&#10;        }&#10;        @Override public String[] getParameterValues(String name) {&#10;            String value = parameters.get(name);&#10;            return value != null ? new String[]{value} : null;&#10;        }&#10;        @Override public String getProtocol() { return &quot;HTTP/1.1&quot;; }&#10;        @Override public String getScheme() { return &quot;http&quot;; }&#10;        @Override public String getServerName() { return &quot;localhost&quot;; }&#10;        @Override public int getServerPort() { return 8080; }&#10;        @Override public java.io.BufferedReader getReader() { return null; }&#10;        @Override public String getRemoteAddr() { return &quot;127.0.0.1&quot;; }&#10;        @Override public String getRemoteHost() { return &quot;localhost&quot;; }&#10;        @Override public void setAttribute(String name, Object o) {}&#10;        @Override public void removeAttribute(String name) {}&#10;        @Override public java.util.Locale getLocale() { return java.util.Locale.getDefault(); }&#10;        @Override public java.util.Enumeration&lt;java.util.Locale&gt; getLocales() { return null; }&#10;        @Override public boolean isSecure() { return false; }&#10;        @Override public javax.servlet.RequestDispatcher getRequestDispatcher(String path) { return null; }&#10;        @Override public int getRemotePort() { return 0; }&#10;        @Override public String getLocalName() { return &quot;localhost&quot;; }&#10;        @Override public String getLocalAddr() { return &quot;127.0.0.1&quot;; }&#10;        @Override public int getLocalPort() { return 8080; }&#10;        @Override public javax.servlet.ServletContext getServletContext() { return null; }&#10;        @Override public javax.servlet.AsyncContext startAsync() { return null; }&#10;        @Override public javax.servlet.AsyncContext startAsync(javax.servlet.ServletRequest servletRequest, javax.servlet.ServletResponse servletResponse) { return null; }&#10;        @Override public boolean isAsyncStarted() { return false; }&#10;        @Override public boolean isAsyncSupported() { return false; }&#10;        @Override public javax.servlet.AsyncContext getAsyncContext() { return null; }&#10;        @Override public javax.servlet.DispatcherType getDispatcherType() { return javax.servlet.DispatcherType.REQUEST; }&#10;        @Override public String getRequestId() { return &quot;test-request-id&quot;; }&#10;        @Override public String getProtocolRequestId() { return &quot;test-protocol-request-id&quot;; }&#10;        @Override public javax.servlet.ServletConnection getServletConnection() { return null; }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/webframe/test/FormValidationTest.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/webframe/test/FormValidationTest.java" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package webframe.test;&#10;&#10;import webframe.core.util.ParameterResolver;&#10;import webframe.core.annotation.RequestParam;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;&#10;import java.lang.reflect.Method;&#10;import java.lang.reflect.Parameter;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;/**&#10; * Test complet pour démontrer l'utilisation avancée du système de formulaires&#10; * et de la validation avec @RequestParam.&#10; */&#10;public class FormValidationTest {&#10;&#10;    public static void main(String[] args) {&#10;        System.out.println(&quot;=== Test Complet du Système de Formulaires avec Validation ===\n&quot;);&#10;&#10;        testFormControllerValidation();&#10;        testParameterMapping();&#10;        testTypeConversion();&#10;        testErrorHandling();&#10;        testComplexFormData();&#10;    }&#10;&#10;    /**&#10;     * Test de validation du contrôleur FormController&#10;     */&#10;    private static void testFormControllerValidation() {&#10;        System.out.println(&quot;1.  Validation du FormController :&quot;);&#10;&#10;        ParameterResolver.ValidationReport report = ParameterResolver.validateController(FormController.class);&#10;        System.out.println(report);&#10;    }&#10;&#10;    /**&#10;     * Test du mapping des noms de paramètres&#10;     */&#10;    private static void testParameterMapping() {&#10;        System.out.println(&quot;2.  Test du Mapping des Paramètres :&quot;);&#10;&#10;        try {&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class, boolean.class, String.class);&#10;&#10;            // Cas 1: Paramètres avec noms correspondants&#10;            MockHttpServletRequest request1 = new MockHttpServletRequest();&#10;            request1.addParameter(&quot;username&quot;, &quot;alice_martin&quot;);&#10;            request1.addParameter(&quot;email&quot;, &quot;alice@exemple.fr&quot;);&#10;            request1.addParameter(&quot;age&quot;, &quot;28&quot;);&#10;            request1.addParameter(&quot;country&quot;, &quot;France&quot;);&#10;            request1.addParameter(&quot;subscribe&quot;, &quot;true&quot;);&#10;            request1.addParameter(&quot;comments&quot;, &quot;Excellent framework !&quot;);&#10;&#10;            Object[] args1 = ParameterResolver.resolveParameters(method, request1);&#10;            System.out.printf(&quot;  ✅ Mapping réussi: username='%s', email='%s', age=%s, country='%s', subscribe=%s%n&quot;,&#10;                args1[0], args1[1], args1[2], args1[3], args1[4]);&#10;&#10;            // Cas 2: Paramètres partiels avec valeurs par défaut&#10;            MockHttpServletRequest request2 = new MockHttpServletRequest();&#10;            request2.addParameter(&quot;username&quot;, &quot;bob_dupont&quot;);&#10;            request2.addParameter(&quot;email&quot;, &quot;bob@test.com&quot;);&#10;            // age, country, subscribe et comments manquants -&gt; valeurs par défaut&#10;&#10;            Object[] args2 = ParameterResolver.resolveParameters(method, request2);&#10;            System.out.printf(&quot;  ✅ Valeurs par défaut: age=%s, country='%s', subscribe=%s, comments='%s'%n&quot;,&#10;                args2[2], args2[3], args2[4], args2[5]);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  ❌ Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    /**&#10;     * Test de la conversion automatique des types&#10;     */&#10;    private static void testTypeConversion() {&#10;        System.out.println(&quot;3.  Test de Conversion des Types :&quot;);&#10;&#10;        try {&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class, boolean.class, String.class);&#10;&#10;            MockHttpServletRequest request = new MockHttpServletRequest();&#10;&#10;            // Test différents formats pour boolean&#10;            request.addParameter(&quot;username&quot;, &quot;test_user&quot;);&#10;            request.addParameter(&quot;email&quot;, &quot;test@example.com&quot;);&#10;            request.addParameter(&quot;age&quot;, &quot;42&quot;);&#10;            request.addParameter(&quot;country&quot;, &quot;Canada&quot;);&#10;            request.addParameter(&quot;subscribe&quot;, &quot;on&quot;); // Format checkbox HTML&#10;            request.addParameter(&quot;comments&quot;, &quot;Tests de conversion&quot;);&#10;&#10;            Object[] args = ParameterResolver.resolveParameters(method, request);&#10;&#10;            System.out.printf(&quot;  ✅ String: '%s' (%s)%n&quot;, args[0], args[0].getClass().getSimpleName());&#10;            System.out.printf(&quot;  ✅ String: '%s' (%s)%n&quot;, args[1], args[1].getClass().getSimpleName());&#10;            System.out.printf(&quot;  ✅ int: %s (%s)%n&quot;, args[2], args[2].getClass().getSimpleName());&#10;            System.out.printf(&quot;  ✅ String: '%s' (%s)%n&quot;, args[3], args[3].getClass().getSimpleName());&#10;            System.out.printf(&quot;  ✅ boolean (from 'on'): %s (%s)%n&quot;, args[4], args[4].getClass().getSimpleName());&#10;            System.out.printf(&quot;  ✅ String: '%s' (%s)%n&quot;, args[5], args[5].getClass().getSimpleName());&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  ❌ Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    /**&#10;     * Test de gestion des erreurs&#10;     */&#10;    private static void testErrorHandling() {&#10;        System.out.println(&quot;4. ⚠️ Test de Gestion des Erreurs :&quot;);&#10;&#10;        try {&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class, boolean.class, String.class);&#10;&#10;            // Test 1: Paramètre requis manquant&#10;            MockHttpServletRequest request1 = new MockHttpServletRequest();&#10;            request1.addParameter(&quot;email&quot;, &quot;test@example.com&quot;);&#10;            // username manquant&#10;&#10;            try {&#10;                ParameterResolver.resolveParameters(method, request1);&#10;                System.out.println(&quot;  ❌ Erreur: devrait lever une exception&quot;);&#10;            } catch (IllegalArgumentException e) {&#10;                System.out.printf(&quot;  ✅ Exception attendue pour paramètre manquant: %s%n&quot;, e.getMessage());&#10;            }&#10;&#10;            // Test 2: Conversion de type impossible&#10;            MockHttpServletRequest request2 = new MockHttpServletRequest();&#10;            request2.addParameter(&quot;username&quot;, &quot;test_user&quot;);&#10;            request2.addParameter(&quot;email&quot;, &quot;test@example.com&quot;);&#10;            request2.addParameter(&quot;age&quot;, &quot;pas_un_nombre&quot;); // Erreur de conversion&#10;&#10;            try {&#10;                ParameterResolver.resolveParameters(method, request2);&#10;                System.out.println(&quot;  ❌ Erreur: devrait lever une exception pour conversion impossible&quot;);&#10;            } catch (IllegalArgumentException e) {&#10;                System.out.printf(&quot;  ✅ Exception attendue pour conversion: %s%n&quot;, e.getMessage());&#10;            }&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  ❌ Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;    }&#10;&#10;    /**&#10;     * Test avec des données de formulaire complexes&#10;     */&#10;    private static void testComplexFormData() {&#10;        System.out.println(&quot;5.  Test de Données Complexes :&quot;);&#10;&#10;        try {&#10;            Method method = FormController.class.getMethod(&quot;handleFormSubmit&quot;,&#10;                String.class, String.class, int.class, String.class, boolean.class, String.class);&#10;&#10;            MockHttpServletRequest request = new MockHttpServletRequest();&#10;&#10;            // Simuler des données de formulaire avec caractères spéciaux&#10;            request.addParameter(&quot;username&quot;, &quot;marie-claire_123&quot;);&#10;            request.addParameter(&quot;email&quot;, &quot;marie.claire+test@domaine-exemple.fr&quot;);&#10;            request.addParameter(&quot;age&quot;, &quot;35&quot;);&#10;            request.addParameter(&quot;country&quot;, &quot;Côte d'Ivoire&quot;);&#10;            request.addParameter(&quot;subscribe&quot;, &quot;1&quot;); // Format numérique pour boolean&#10;            request.addParameter(&quot;comments&quot;, &quot;Voici un commentaire avec des accents: éàùç et émojis &quot;);&#10;&#10;            Object[] args = ParameterResolver.resolveParameters(method, request);&#10;&#10;            System.out.printf(&quot;  ✅ Username avec tirets/underscores: '%s'%n&quot;, args[0]);&#10;            System.out.printf(&quot;  ✅ Email complexe: '%s'%n&quot;, args[1]);&#10;            System.out.printf(&quot;  ✅ Âge: %s ans%n&quot;, args[2]);&#10;            System.out.printf(&quot;  ✅ Pays avec accents: '%s'%n&quot;, args[3]);&#10;            System.out.printf(&quot;  ✅ Boolean depuis '1': %s%n&quot;, args[4]);&#10;            System.out.printf(&quot;  ✅ Commentaire avec caractères spéciaux: '%s'%n&quot;, args[5]);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;  ❌ Erreur: &quot; + e.getMessage());&#10;        }&#10;        System.out.println();&#10;&#10;        System.out.println(&quot; Tests terminés avec succès !&quot;);&#10;        System.out.println(&quot;\n Résumé des fonctionnalités validées :&quot;);&#10;        System.out.println(&quot;   ✅ Mapping automatique des paramètres HTTP vers méthodes Java&quot;);&#10;        System.out.println(&quot;   ✅ Support des annotations @RequestParam avec value, name, required, defaultValue&quot;);&#10;        System.out.println(&quot;   ✅ Conversion automatique des types (String, int, boolean, etc.)&quot;);&#10;        System.out.println(&quot;   ✅ Gestion des valeurs par défaut pour paramètres optionnels&quot;);&#10;        System.out.println(&quot;   ✅ Validation des paramètres requis avec exceptions informatives&quot;);&#10;        System.out.println(&quot;   ✅ Support des formats HTML standards (checkbox 'on', boolean '1', etc.)&quot;);&#10;        System.out.println(&quot;   ✅ Gestion des caractères spéciaux et accents dans les données&quot;);&#10;        System.out.println(&quot;   ✅ Système de validation du contrôleur pour détecter les problèmes de configuration&quot;);&#10;    }&#10;&#10;    /**&#10;     * Mock simple de HttpServletRequest pour les tests&#10;     */&#10;    private static class MockHttpServletRequest implements HttpServletRequest {&#10;        private Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();&#10;&#10;        public void addParameter(String name, String value) {&#10;            parameters.put(name, value);&#10;        }&#10;&#10;        @Override&#10;        public String getParameter(String name) {&#10;            return parameters.get(name);&#10;        }&#10;&#10;        // Implémentation minimale des autres méthodes requises&#10;        @Override public String getAuthType() { return null; }&#10;        @Override public javax.servlet.http.Cookie[] getCookies() { return new javax.servlet.http.Cookie[0]; }&#10;        @Override public long getDateHeader(String name) { return 0; }&#10;        @Override public String getHeader(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getHeaders(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getHeaderNames() { return null; }&#10;        @Override public int getIntHeader(String name) { return 0; }&#10;        @Override public String getMethod() { return &quot;POST&quot;; }&#10;        @Override public String getPathInfo() { return null; }&#10;        @Override public String getPathTranslated() { return null; }&#10;        @Override public String getContextPath() { return &quot;&quot;; }&#10;        @Override public String getQueryString() { return null; }&#10;        @Override public String getRemoteUser() { return null; }&#10;        @Override public boolean isUserInRole(String role) { return false; }&#10;        @Override public java.security.Principal getUserPrincipal() { return null; }&#10;        @Override public String getRequestedSessionId() { return null; }&#10;        @Override public String getRequestURI() { return &quot;/form/submit&quot;; }&#10;        @Override public StringBuffer getRequestURL() { return new StringBuffer(&quot;http://localhost/form/submit&quot;); }&#10;        @Override public String getServletPath() { return &quot;&quot;; }&#10;        @Override public javax.servlet.http.HttpSession getSession(boolean create) { return null; }&#10;        @Override public javax.servlet.http.HttpSession getSession() { return null; }&#10;        @Override public String changeSessionId() { return null; }&#10;        @Override public boolean isRequestedSessionIdValid() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromCookie() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromURL() { return false; }&#10;        @Override public boolean isRequestedSessionIdFromUrl() { return false; }&#10;        @Override public boolean authenticate(javax.servlet.http.HttpServletResponse response) { return false; }&#10;        @Override public void login(String username, String password) {}&#10;        @Override public void logout() {}&#10;        @Override public java.util.Collection&lt;javax.servlet.http.Part&gt; getParts() { return null; }&#10;        @Override public javax.servlet.http.Part getPart(String name) { return null; }&#10;        @Override public &lt;T extends javax.servlet.http.HttpUpgradeHandler&gt; T upgrade(Class&lt;T&gt; httpUpgradeHandlerClass) { return null; }&#10;        @Override public Object getAttribute(String name) { return null; }&#10;        @Override public java.util.Enumeration&lt;String&gt; getAttributeNames() { return null; }&#10;        @Override public String getCharacterEncoding() { return &quot;UTF-8&quot;; }&#10;        @Override public void setCharacterEncoding(String env) {}&#10;        @Override public int getContentLength() { return 0; }&#10;        @Override public long getContentLengthLong() { return 0; }&#10;        @Override public String getContentType() { return &quot;application/x-www-form-urlencoded&quot;; }&#10;        @Override public javax.servlet.ServletInputStream getInputStream() { return null; }&#10;        @Override public java.util.Map&lt;String, String[]&gt; getParameterMap() {&#10;            Map&lt;String, String[]&gt; map = new HashMap&lt;&gt;();&#10;            for (Map.Entry&lt;String, String&gt; entry : parameters.entrySet()) {&#10;                map.put(entry.getKey(), new String[]{entry.getValue()});&#10;            }&#10;            return map;&#10;        }&#10;        @Override public java.util.Enumeration&lt;String&gt; getParameterNames() {&#10;            return java.util.Collections.enumeration(parameters.keySet());&#10;        }&#10;        @Override public String[] getParameterValues(String name) {&#10;            String value = parameters.get(name);&#10;            return value != null ? new String[]{value} : null;&#10;        }&#10;        @Override public String getProtocol() { return &quot;HTTP/1.1&quot;; }&#10;        @Override public String getScheme() { return &quot;http&quot;; }&#10;        @Override public String getServerName() { return &quot;localhost&quot;; }&#10;        @Override public int getServerPort() { return 8080; }&#10;        @Override public java.io.BufferedReader getReader() { return null; }&#10;        @Override public String getRemoteAddr() { return &quot;127.0.0.1&quot;; }&#10;        @Override public String getRemoteHost() { return &quot;localhost&quot;; }&#10;        @Override public void setAttribute(String name, Object o) {}&#10;        @Override public void removeAttribute(String name) {}&#10;        @Override public java.util.Locale getLocale() { return java.util.Locale.getDefault(); }&#10;        @Override public java.util.Enumeration&lt;java.util.Locale&gt; getLocales() { return null; }&#10;        @Override public boolean isSecure() { return false; }&#10;        @Override public javax.servlet.RequestDispatcher getRequestDispatcher(String path) { return null; }&#10;        @Override public int getRemotePort() { return 0; }&#10;        @Override public String getLocalName() { return &quot;localhost&quot;; }&#10;        @Override public String getLocalAddr() { return &quot;127.0.0.1&quot;; }&#10;        @Override public int getLocalPort() { return 8080; }&#10;        @Override public javax.servlet.ServletContext getServletContext() { return null; }&#10;        @Override public javax.servlet.AsyncContext startAsync() { return null; }&#10;        @Override public javax.servlet.AsyncContext startAsync(javax.servlet.ServletRequest servletRequest, javax.servlet.ServletResponse servletResponse) { return null; }&#10;        @Override public boolean isAsyncStarted() { return false; }&#10;        @Override public boolean isAsyncSupported() { return false; }&#10;        @Override public javax.servlet.AsyncContext getAsyncContext() { return null; }&#10;        @Override public javax.servlet.DispatcherType getDispatcherType() { return javax.servlet.DispatcherType.REQUEST; }&#10;        @Override public String getRequestId() { return &quot;validation-test-request&quot;; }&#10;        @Override public String getProtocolRequestId() { return &quot;validation-test-protocol&quot;; }&#10;        @Override public javax.servlet.ServletConnection getServletConnection() { return null; }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>